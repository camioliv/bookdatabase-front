{"remainingRequest":"/home/camila/copy_myProject/book-database/book-database-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/camila/copy_myProject/book-database/book-database-front/src/components/ViewBook.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/camila/copy_myProject/book-database/book-database-front/src/components/ViewBook.vue","mtime":1588266081490},{"path":"/home/camila/copy_myProject/book-database/book-database-front/node_modules/cache-loader/dist/cjs.js","mtime":1588228965688},{"path":"/home/camila/copy_myProject/book-database/book-database-front/node_modules/babel-loader/lib/index.js","mtime":1588228965672},{"path":"/home/camila/copy_myProject/book-database/book-database-front/node_modules/vuetify-loader/lib/loader.js","mtime":1588228966316},{"path":"/home/camila/copy_myProject/book-database/book-database-front/node_modules/cache-loader/dist/cjs.js","mtime":1588228965688},{"path":"/home/camila/copy_myProject/book-database/book-database-front/node_modules/vue-loader/lib/index.js","mtime":1588228966292}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBCb29rIGZyb20gIkAvc2VydmljZXMvYm9va3MiOwppbXBvcnQgTG9jYXRpb24gZnJvbSAiQC9zZXJ2aWNlcy9sb2NhdGlvbnMiOwoKZXhwb3J0IGRlZmF1bHQgewogIHByb3BzOiB7CiAgICB2aWV3Qm9vazogQm9vbGVhbiwKICAgIGJvb2tQYXJlbnQ6IE9iamVjdAogIH0sCiAgZGF0YTogKCkgPT4gKHsKICAgIGFsZXJ0OiB7CiAgICAgIHR5cGU6ICIiLAogICAgICBtZXNzYWdlOiAiIiwKICAgICAgdmlzaWJsZTogZmFsc2UKICAgIH0sCiAgICBsb2NhdGlvbjogewogICAgICBuYW1lOiAiIgogICAgfSwKICAgIHJlZnJlc2hMb2NhdGlvbnM6IGZhbHNlLAogICAgbG9jYXRpb25zOiB7CiAgICAgIGlkOiAwLAogICAgICBuYW1lOiAiIgogICAgfSwKICAgIGxvYWRpbmc6IGZhbHNlLAogICAgc2VhcmNoTG9jYXRpb25zOiBudWxsLAogICAgYm9vazogewogICAgICBpc2JuOiAiIiwKICAgICAgdGl0bGU6ICIiLAogICAgICBwYWdlczogIiIsCiAgICAgIGltYWdlOiAiIiwKICAgICAgbGFzdFZpZXdkOiAiIiwKICAgICAgYXV0aG9yczogW3sgbmFtZTogIiIgfV0sCiAgICAgIGxvY2F0aW9uOiB7CiAgICAgICAgaWQ6IDAsCiAgICAgICAgbmFtZTogIiIKICAgICAgfSwKICAgICAgcmF0aW5nczogewogICAgICAgIHVzZXI6IHsKICAgICAgICAgIGlkOiAxLAogICAgICAgICAgbmFtZTogIkd1ZXN0IgogICAgICAgIH0sCiAgICAgICAgc3RhcnM6IDAKICAgICAgfQogICAgfQogIH0pLAoKICB3YXRjaDogewogICAgc2VhcmNoTG9jYXRpb25zKHZhbCkgewogICAgICBpZiAodGhpcy5sb2NhdGlvbnMubGVuZ3RoID4gMCAmJiAhdGhpcy5yZWZyZXNoTG9jYXRpb25zKSByZXR1cm47CiAgICAgIGlmICh0aGlzLmxvYWRpbmcpIHJldHVybjsKICAgICAgaWYgKHZhbCA9PSBudWxsKSByZXR1cm47CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgIExvY2F0aW9uLmxpc3QoKQogICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgIHRoaXMubG9jYXRpb25zID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgICAgfSkKICAgICAgICAuZmluYWxseSgKICAgICAgICAgICgpID0+ICgodGhpcy5sb2FkaW5nID0gZmFsc2UpLCAodGhpcy5yZWZyZXNoTG9jYXRpb25zID0gZmFsc2UpKQogICAgICAgICk7CiAgICB9LAogICAgdmlld0Jvb2soKSB7CiAgICAgIGlmICh0aGlzLnZpZXdCb29rKSB7CiAgICAgICAgdGhpcy5ib29rID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5ib29rUGFyZW50KTsKICAgICAgICB0aGlzLmJvb2sucmF0aW5ncy51c2VyID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy51c2VyKTsKICAgICAgICB2YXIgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpOwogICAgICAgIHRoaXMuYm9vay5sYXN0Vmlld2QgPSBjdXJyZW50RGF0ZTsKICAgICAgICB0aGlzLnNhdmVCb29rKCk7CiAgICAgIH0KICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIHNhdmVCb29rKG1lc3NhZ2UpIHsKICAgICAgdGhpcy5ib29rLnJhdGluZ3MudXNlci5pZCA9IDE7CiAgICAgIEJvb2sudXBkYXRlKHRoaXMuYm9vaykKICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSkgewogICAgICAgICAgICBpZiAobWVzc2FnZSl7CiAgICAgICAgICAgIHRoaXMuTWVzc2FnZSgic3VjY2VzcyIsICJCb29rIHN1Y2Nlc3NmdWxseSB1cGRhdGVkIik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgICAgfSk7CiAgICB9LAogICAgc2F2ZUFuZENsb3NlKCkgewogICAgICB0aGlzLnNhdmVCb29rKCk7CiAgICAgIHRoaXMuJGVtaXQoInVwZGF0ZTp2aWV3Qm9vayIsIGZhbHNlKTsKICAgIH0sCiAgICBNZXNzYWdlKHR5cGUsIG1lc3NhZ2UpIHsKICAgICAgKHRoaXMuYWxlcnQudmlzaWJsZSA9IHRydWUpLAogICAgICAgICh0aGlzLmFsZXJ0LnR5cGUgPSB0eXBlKSwKICAgICAgICAodGhpcy5hbGVydC5tZXNzYWdlID0gbWVzc2FnZSk7CiAgICB9LAogICAgc2VhcmNoQm9vaygpIHsKICAgICAgQm9vay5saXN0QnlJZCh0aGlzLnByb3BzLmJvb2tJZCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgdGhpcy5ib29rID0gcmVzcG9uc2UuZGF0YTsKICAgICAgfSk7CiAgICB9LAoKICAgIHNlYXJjaEJvb2tFeHQoKSB7CiAgICAgIEJvb2suZXh0U2VhcmNoSVNCTih0aGlzLmJvb2suaXNibikudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgKHRoaXMuYm9vay50aXRsZSA9IHJlc3BvbnNlLmRhdGEuYm9vay50aXRsZSksCiAgICAgICAgICAodGhpcy5ib29rLnBhZ2VzID0gcmVzcG9uc2UuZGF0YS5ib29rLnBhZ2VzKSwKICAgICAgICAgICh0aGlzLmJvb2suaW1hZ2UgPSByZXNwb25zZS5kYXRhLmJvb2suaW1hZ2UpOwoKICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5ib29rLmF1dGhvcnMubGVuZ3RoID4gMCkgewogICAgICAgICAgKHRoaXMuYm9vay5hdXRob3JzID0gW10pLAogICAgICAgICAgICByZXNwb25zZS5kYXRhLmJvb2suYXV0aG9ycy5mb3JFYWNoKGl0ZW0gPT4gewogICAgICAgICAgICAgIHZhciBhdXRob3IgPSBuZXcgT2JqZWN0KCk7CiAgICAgICAgICAgICAgYXV0aG9yLm5hbWUgPSBpdGVtOwogICAgICAgICAgICAgIHRoaXMuYm9vay5hdXRob3JzLnB1c2goYXV0aG9yKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmFsZXJ0LnZpc2libGU9IGZhbHNlLAogICAgTG9jYXRpb24ubGlzdCgpCiAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICB0aGlzLmxvY2F0aW9ucyA9IHJlc3BvbnNlLmRhdGE7CiAgICAgIH0pCiAgICAgIC5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICB9KQogICAgICAuZmluYWxseSgoKSA9PiAoKHRoaXMubG9hZGluZyA9IGZhbHNlKSwgKHRoaXMucmVmcmVzaExvY2F0aW9ucyA9IGZhbHNlKSkpOwogIH0KfTsK"},{"version":3,"sources":["ViewBook.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0DA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ViewBook.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <v-row justify=\"center\">\n    <v-dialog v-model=\"viewBook\" persistent max-width=\"750px\">\n      <v-card>\n        <v-card-title>\n          <span class=\"headline grey--text text--darken-2\"></span>\n        </v-card-title>\n        <v-card-text class=\"text-left text-light condensed\">\n          <v-row>\n            <v-col cols=\"6\" sm=\"4\" md=\"3\">\n              <v-img v-bind:src=\"book.image\"></v-img>\n            </v-col>\n            <v-col cols=\"6\" sm=\"8\" md=\"9\">\n              <v-text-field\n                v-model=\"book.isbn\"\n                v-on:change.native=\"searchBookExt\"\n                label=\"ISBN\"\n                required\n              ></v-text-field>\n              <v-text-field label=\"Title\" v-model=\"book.title\" required></v-text-field>\n              <div v-for=\"(author, index) in book.authors\" v-bind:key=\"index\">\n                <v-text-field label=\"Author\" v-model=\"author.name\"></v-text-field>\n              </div>\n              <v-text-field label=\"Pages\" v-model=\"book.pages\" type=\"number\"></v-text-field>\n            </v-col>\n            <v-col cols=\"10\">\n              <v-autocomplete\n                v-model=\"book.location\"\n                :loading=\"loading\"\n                :items=\"locations\"\n                item-text=\"name\"\n                item-value=\"id\"\n                :search-input.sync=\"searchLocations\"\n                no-filter\n                hide-no-data\n                clearable\n                return-object\n                label=\"Location\"\n                required\n              ></v-autocomplete>\n            </v-col>\n          </v-row>\n          <v-col cols=\"6\">\n            <v-rating v-model=\"book.ratings.stars\" background-color=\"orange\" color=\"orange\" medium></v-rating>\n          </v-col>\n        </v-card-text>\n        <v-card-actions>\n          <v-spacer></v-spacer>\n          <v-btn color=\"blue darken-1\" text v-on:click=\"$emit('update:viewBook', false)\">Close</v-btn>\n          <v-btn color=\"blue darken-1\" text v-on:click=\"saveBook\">Save</v-btn>\n        </v-card-actions>\n      </v-card>\n       <v-alert :type=\"alert.type\" v-model=\"alert.visible\" dismissible>{{alert.message}}</v-alert>\n    </v-dialog>\n  </v-row>\n</template>\n\n<script>\nimport Book from \"@/services/books\";\nimport Location from \"@/services/locations\";\n\nexport default {\n  props: {\n    viewBook: Boolean,\n    bookParent: Object\n  },\n  data: () => ({\n    alert: {\n      type: \"\",\n      message: \"\",\n      visible: false\n    },\n    location: {\n      name: \"\"\n    },\n    refreshLocations: false,\n    locations: {\n      id: 0,\n      name: \"\"\n    },\n    loading: false,\n    searchLocations: null,\n    book: {\n      isbn: \"\",\n      title: \"\",\n      pages: \"\",\n      image: \"\",\n      lastViewd: \"\",\n      authors: [{ name: \"\" }],\n      location: {\n        id: 0,\n        name: \"\"\n      },\n      ratings: {\n        user: {\n          id: 1,\n          name: \"Guest\"\n        },\n        stars: 0\n      }\n    }\n  }),\n\n  watch: {\n    searchLocations(val) {\n      if (this.locations.length > 0 && !this.refreshLocations) return;\n      if (this.loading) return;\n      if (val == null) return;\n      this.loading = true;\n      Location.list()\n        .then(response => {\n          this.locations = response.data;\n        })\n        .catch(error => {\n          console.log(error);\n        })\n        .finally(\n          () => ((this.loading = false), (this.refreshLocations = false))\n        );\n    },\n    viewBook() {\n      if (this.viewBook) {\n        this.book = Object.assign({}, this.bookParent);\n        this.book.ratings.user = Object.assign({}, this.user);\n        var currentDate = new Date();\n        this.book.lastViewd = currentDate;\n        this.saveBook();\n      }\n    }\n  },\n  methods: {\n    saveBook(message) {\n      this.book.ratings.user.id = 1;\n      Book.update(this.book)\n        .then(response => {\n          if (response.data) {\n            if (message){\n            this.Message(\"success\", \"Book successfully updated\");\n            }\n          }\n        })\n        .catch(error => {\n          console.log(error);\n        });\n    },\n    saveAndClose() {\n      this.saveBook();\n      this.$emit(\"update:viewBook\", false);\n    },\n    Message(type, message) {\n      (this.alert.visible = true),\n        (this.alert.type = type),\n        (this.alert.message = message);\n    },\n    searchBook() {\n      Book.listById(this.props.bookId).then(response => {\n        this.book = response.data;\n      });\n    },\n\n    searchBookExt() {\n      Book.extSearchISBN(this.book.isbn).then(response => {\n        (this.book.title = response.data.book.title),\n          (this.book.pages = response.data.book.pages),\n          (this.book.image = response.data.book.image);\n\n        if (response.data.book.authors.length > 0) {\n          (this.book.authors = []),\n            response.data.book.authors.forEach(item => {\n              var author = new Object();\n              author.name = item;\n              this.book.authors.push(author);\n            });\n        }\n      });\n    }\n  },\n  mounted() {\n    this.alert.visible= false,\n    Location.list()\n      .then(response => {\n        this.locations = response.data;\n      })\n      .catch(error => {\n        console.log(error);\n      })\n      .finally(() => ((this.loading = false), (this.refreshLocations = false)));\n  }\n};\n</script>\n"]}]}